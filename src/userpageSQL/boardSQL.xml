<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">
		<!-- 전체 리스트 불러오기 -->
		<select id="article" resultType="userpage.board.otoDTO">
			SELECT
				num,
				writer,
				email,
				subject,
				passwd,
				reg_date,
				ref,
				re_step,
				re_level,
				content,
				ip,
				readcount,
				r
			FROM
				otoboard
			ORDER BY
				otonum desc,
				re_step asc
		</select>
		
	    <!-- 게시글 작성 -->
    <insert id="insert">
        INSERT INTO tbl_board (
          num, 
          readcount, 
          re_level, 
          content,
          writer,
          reg_date,
          subject,
          ph,
          save,
          otonum
        ) VALUES (
          (SELECT NVL(MAX(num)+1, 1)FROM otoboard),
          #{subject},
          #{content},
          #{writer}
        )
    </insert>
    
    <!-- 게시글 상세보기 조회 -->
    <select id="view" resultType="view/userpage/oto/otoContent.jsp">
        SELECT * FROM otoboard 
        WHERE num = #{num}
    </select>
    
    <!-- 게시글 조회수 증가 -->
    <update id="readcountUp">
        UPDATE tbl_board SET readcount = readcount + 1 
        WHERE num = #{num}
    </update>
    
    <!-- 게시글 수정 -->
    <update id="updateArticle">
        UPDATE otoboard SET
            title = #{subject},
            content = #{content},
            writer = #{writer}
        WHERE num = #{num}
    </update>
    
    <!-- 게시글 삭제 -->
    <delete id="deleteArticle">
        DELETE FROM otoboard
        WHERE num = #{num}
    </delete>
	
	
</mapper>